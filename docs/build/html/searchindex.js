Search.setIndex({"docnames": ["api", "examples", "fiber_views", "fiber_views.depr", "generated/fiber_views", "index", "install", "modules", "usage"], "filenames": ["api.rst", "examples.rst", "fiber_views.rst", "fiber_views.depr.rst", "generated/fiber_views.rst", "index.rst", "install.rst", "modules.rst", "usage.rst"], "titles": ["API", "Examples", "fiber_views package", "fiber_views.depr package", "fiber_views", "fiber-views documentation", "Install", "fiber_views", "testing usage"], "terms": {"main": 2, "build_multi_fview": [2, 7], "bam_fil": 2, "sites_df": [2, 3], "mod_def": 2, "region_def": 2, "window": [2, 3], "1000": [2, 3], "fully_span": [2, 3], "true": [2, 3], "region_interv": [2, 3], "30": [2, 3], "filter_arg": [2, 3], "cutoff": [2, 3], "2": [2, 3], "dist": [2, 3], "3000": [2, 3], "tag": [2, 3], "np": [2, 3], "ec": [2, 3], "rq": [2, 3], "max_read": [2, 3], "300": [2, 3], "build_single_fview": [2, 7], "site_info": 2, "creat": [2, 6], "wed": 2, "aug": 2, "28": 2, "13": 2, "33": 2, "42": 2, "2024": 2, "author": 2, "morgan": 2, "annotate_boundari": [2, 7], "fview": [2, 3, 8], "draw_fiber_bar": [2, 7], "ax": [2, 3], "none": [2, 3, 8], "color": [2, 3], "d0d0d0": 2, "width": [2, 3], "0": 2, "8": 2, "draw_fiber_lin": [2, 7], "606060": 2, "draw_mod": [2, 7], "mod": [2, 3], "m6a": [2, 3], "000000": 2, "draw_mods_offset": [2, 7], "draw_region": [2, 7], "base_nam": 2, "msp": [2, 3], "red": 2, "draw_split_lin": [2, 7], "split_var": [2, 3], "site_nam": 2, "black": 2, "make_plot_ax": [2, 7], "sep": 2, "7": 2, "14": 2, "37": 2, "04": 2, "2022": 2, "descript": 2, "A": 2, "set": [2, 3], "useful": [2, 3], "workign": 2, "fiber": [2, 3, 6, 8], "view": [2, 3, 6, 8], "agg_by_obs_and_bin": [2, 7], "obs_group_var": 2, "bin_width": [2, 3], "10": [2, 3], "obs_to_keep": 2, "seqid": 2, "po": 2, "strand": [2, 7], "fast": 2, "region_weight": 2, "ones": 2, "aggreg": 2, "data": [2, 3, 8], "group": [2, 3], "variabl": 2, "ob": [2, 3], "datafram": 2, "bin": [2, 3], "bin_widht": 2, "basepair": 2, "paramet": [2, 3, 8], "anndata": [2, 3, 8], "The": [2, 3, 8], "object": [2, 3, 8], "contain": [2, 3, 8], "str": [2, 3], "option": [2, 3], "name": [2, 3], "us": [2, 3, 5], "default": [2, 3], "valu": [2, 3], "i": [2, 3, 8], "If": 2, "row": [2, 3], "order": 2, "preserv": 2, "int": [2, 3, 8], "each": [2, 3, 8], "base": [2, 3], "pair": 2, "1": 2, "list": [2, 8], "observ": [2, 8], "metadata": 2, "column": [2, 8], "keep": 2, "bool": [2, 3], "modif": [2, 3], "matric": 2, "convert": 2, "dens": 2, "faster": 2, "calcul": 2, "thi": [2, 3, 8], "mai": 2, "more": 2, "memori": 2, "larg": 2, "how": 2, "weight": 2, "region": 2, "when": 2, "must": 2, "one": 2, "length": [2, 8], "score": 2, "return": [2, 3, 8], "an": 2, "version": 2, "input": 2, "accord": 2, "specifi": [2, 3], "type": [2, 3, 8], "bin_sparse_region": [2, 7], "nuc": 2, "interv": 2, "3": 2, "averag": 2, "over": 2, "consecut": 2, "should": [2, 3], "nucleosom": [2, 3], "methyl": [2, 3], "sensit": 2, "patch": 2, "between": [2, 3], "tupl": 2, "posit": 2, "store": [2, 8], "coordin": 2, "format": 2, "spars": [2, 3], "scipi": 2, "coo_matrix": 2, "calc_kmer_dist": [2, 7], "metric": 2, "cityblock": 2, "pairwis": 2, "k": [2, 8], "mer": [2, 8], "distanc": 2, "function": [2, 3, 8], "count": [2, 8], "kmer": [2, 8], "element": [2, 3, 8], "obsm": [2, 8], "attribut": [2, 3, 8], "can": [2, 3], "result": [2, 8], "matrix": [2, 8], "kmer_dist": 2, "obsp": 2, "count_kmer": [2, 7, 8], "occurr": [2, 8], "map": [2, 3, 8], "from": [2, 8], "string": [2, 8], "indic": [2, 3, 8], "ar": [2, 8], "kmer_len": [2, 8], "kmer_idx": [2, 8], "un": [2, 8], "respect": [2, 8], "dna": [2, 3, 8], "sequenc": [2, 3, 8], "seq": [2, 3, 8], "layer": [2, 3, 8], "updat": [2, 8], "place": [2, 8], "ad": [2, 8], "new": [2, 8], "add": [2, 5, 8], "two": [2, 8], "entri": [2, 8], "dictionari": [2, 8], "were": [2, 8], "repres": [2, 3, 8], "byte": [2, 8], "filter_region": [2, 7], "new_base_nam": 2, "length_limit": 2, "inf": 2, "score_limit": 2, "inplac": 2, "fals": [2, 3], "filter": 2, "limit": 2, "save": 2, "inform": 2, "modifi": 2, "float": 2, "lower": 2, "upper": 2, "outsid": 2, "out": 2, "which": [2, 3], "includ": 2, "all": 2, "select": 2, "get_seq_record": [2, 3, 7], "id_col": [2, 3], "read_nam": [2, 3], "get_sequ": [2, 7], "where": [2, 3], "make_dense_region": [2, 7], "report": 2, "represent": 2, "infrom": 2, "size": 2, "number": [2, 3], "present": 2, "either": 2, "occupi": 2, "numpi": 2, "ndarrai": 2, "make_region_df": [2, 7], "zero_po": 2, "left": 2, "zero": 2, "point": 2, "start": 2, "center": 2, "right": 2, "index": 2, "panda": 2, "mark_cpg_sit": [2, 3, 7], "split_fir": [2, 7], "input_region": 2, "threshold": 2, "output_region": 2, "lnk": 2, "fire": [2, 3], "tue": 2, "16": 2, "05": 2, "34": 2, "class": [2, 3], "readlist": [2, 7], "normal_list": 2, "simpl": 2, "pysam": 2, "libcalignedseg": 2, "pileupread": 2, "plu": 2, "method": [2, 6], "construct": 2, "read": 2, "also": 2, "track": 2, "info": 2, "genom": 2, "queri": 2, "build_anno_df": [2, 7], "anno_seri": 2, "frame": 2, "seri": 2, "df": [2, 3], "build_mod_arrai": [2, 7], "mod_typ": 2, "t": 2, "score_cutoff": 2, "200": 2, "integ": 2, "window_offset": 2, "form": 2, "window_start": 2, "window_end": 2, "consid": 2, "m6a_mod": 2, "provid": 2, "odif": 2, "minimum": 2, "requir": 2, "mod_mtx": 2, "arrai": 2, "build_mod_array_from_def": [2, 7], "build_seq_arrai": [2, 7], "char_arrai": 2, "note": 2, "make": 2, "sure": 2, "befor": 2, "build_sparse_region_arrai": [2, 7], "n": 2, "nl": 2, "determin": 2, "subset": 2, "still": 2, "region_mtx": 2, "filter_by_end_meth": [2, 7], "remov": 2, "thei": 2, "have": 2, "fewer": 2, "than": 2, "within": [2, 3], "end": 2, "filter_by_window": [2, 7], "do": 2, "fulli": 2, "span": 2, "given": 2, "get_read": [2, 7], "alignment_fil": [2, 3], "ref_po": 2, "retriev": 2, "bam": 2, "file": [2, 6], "refer": 2, "alignmentfil": 2, "open": 2, "reference_nam": 2, "max": 2, "load": 2, "speed": 2, "up": [2, 3], "process": 2, "coverag": 2, "deep": 2, "self": 2, "exampl": [2, 5], "bamfil": 2, "chr3": 2, "200000": 2, "print_aligned_cent": [2, 7], "offset": 2, "5": 2, "print": 2, "side": 2, "test": 2, "align": 2, "correctli": 2, "output": 2, "bed_to_anno_df": [2, 7], "bed_df": 2, "entry_name_typ": 2, "gene_id": 2, "bed": 2, "anoth": 2, "differ": [2, 3], "layout": 2, "chrom": 2, "uniqu": 2, "identifi": 2, "featur": [2, 3], "anno_df": 2, "get_mod_pos_from_rec": [2, 7], "rec": 2, "record": 2, "alignedseg": 2, "code": [2, 3], "mod_posit": 2, "get_strand_correct_mod": [2, 7], "correct": 2, "match": 2, "forward": 2, "whether": [2, 3], "around": 2, "get_strand_correct_mods_from_def": [2, 7], "get_strand_correct_region": [2, 7], "them": 2, "make_sparse_region": [2, 7], "region_df": 2, "shape": 2, "take": 2, "well": [2, 3], "other": 2, "three": 2, "associ": 2, "first": 2, "second": 2, "bp": 2, "coo": 2, "after": 2, "neg": 2, "print_mod_context": [2, 7], "use_strand": 2, "context": 2, "surround": 2, "revers": 2, "read_b": [2, 7], "bed_fil": 2, "path": 2, "follow": 2, "standard": 2, "top": [2, 4], "level": [2, 3, 4], "packag": [4, 5, 7], "your": [3, 5], "content": [5, 7], "restructuredtext": 5, "syntax": 5, "see": 5, "detail": 5, "fiber_view": [5, 8], "submodul": [5, 7], "annot": 2, "modul": [5, 7], "cli": [], "plot": [3, 5, 7], "tool": [5, 7, 8], "util": [5, 7], "current": 6, "git": 6, "clone": 6, "http": 6, "github": 6, "com": 6, "morganhamm": 6, "cd": 6, "conda": 6, "env": 6, "yml": 6, "activ": 6, "pip": 6, "e": 6, "depr": [2, 7], "fiberview": [2, 3], "build_fview": [2, 3], "plot_methyl": [2, 3], "plot_summari": [2, 3], "simple_region_plot": [2, 3], "min_mod_scor": 3, "220": 3, "mark_cpg": 3, "label_bas": 3, "heatmap": 3, "gener": 3, "state": 3, "unmethyl": 3, "5mc": 3, "label": 3, "cpg": 3, "matplotlib": 3, "_subplot": 3, "axessubplot": 3, "sdata": 3, "summari": 3, "frequenc": 3, "line": 3, "summar": 3, "show": 3, "total": 3, "site": 3, "displai": 3, "presenc": 3, "absenc": 3, "unmodifi": 3, "field": 3, "white": 3, "drawn": 3, "ani": 3, "chang": 3, "split": 3, "cluster": 3, "visual": 3, "deprec": 3, "subpackag": [3, 5, 7], "To": 3, "call": 3}, "objects": {"": [[2, 0, 0, "-", "fiber_views"]], "fiber_views": [[3, 0, 0, "-", "depr"], [2, 0, 0, "-", "fiber_views"], [2, 0, 0, "-", "plot"], [2, 0, 0, "-", "tools"], [2, 0, 0, "-", "utils"]], "fiber_views.depr": [[3, 0, 0, "-", "fiber_views"], [3, 0, 0, "-", "tools"]], "fiber_views.depr.fiber_views": [[3, 1, 1, "", "FiberView"], [3, 3, 1, "", "build_fview"]], "fiber_views.depr.fiber_views.FiberView": [[3, 2, 1, "", "get_seq_records"], [3, 2, 1, "", "mark_cpg_sites"]], "fiber_views.depr.tools": [[3, 3, 1, "", "plot_methylation"], [3, 3, 1, "", "plot_summary"], [3, 3, 1, "", "simple_region_plot"]], "fiber_views.fiber_views": [[2, 3, 1, "", "build_multi_fview"], [2, 3, 1, "", "build_single_fview"]], "fiber_views.plot": [[2, 3, 1, "", "annotate_boundaries"], [2, 3, 1, "", "draw_fiber_bars"], [2, 3, 1, "", "draw_fiber_lines"], [2, 3, 1, "", "draw_mods"], [2, 3, 1, "", "draw_mods_offset"], [2, 3, 1, "", "draw_regions"], [2, 3, 1, "", "draw_split_lines"], [2, 3, 1, "", "make_plot_ax"]], "fiber_views.tools": [[2, 3, 1, "", "agg_by_obs_and_bin"], [2, 3, 1, "", "bin_sparse_regions"], [2, 3, 1, "", "calc_kmer_dist"], [2, 3, 1, "", "count_kmers"], [2, 3, 1, "", "filter_regions"], [2, 3, 1, "", "get_seq_records"], [2, 3, 1, "", "get_sequences"], [2, 3, 1, "", "make_dense_regions"], [2, 3, 1, "", "make_region_df"], [2, 3, 1, "", "mark_cpg_sites"], [2, 3, 1, "", "split_fire"]], "fiber_views.utils": [[2, 1, 1, "", "ReadList"], [2, 3, 1, "", "bed_to_anno_df"], [2, 3, 1, "", "get_mod_pos_from_rec"], [2, 3, 1, "", "get_strand_correct_mods"], [2, 3, 1, "", "get_strand_correct_mods_from_def"], [2, 3, 1, "", "get_strand_correct_regions"], [2, 3, 1, "", "make_sparse_regions"], [2, 3, 1, "", "print_mod_contexts"], [2, 3, 1, "", "read_bed"]], "fiber_views.utils.ReadList": [[2, 2, 1, "", "build_anno_df"], [2, 2, 1, "", "build_mod_array"], [2, 2, 1, "", "build_mod_array_from_def"], [2, 2, 1, "", "build_seq_array"], [2, 2, 1, "", "build_sparse_region_array"], [2, 2, 1, "", "filter_by_end_meth"], [2, 2, 1, "", "filter_by_window"], [2, 2, 1, "", "get_reads"], [2, 2, 1, "", "print_aligned_centers"], [2, 4, 1, "", "strand"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"api": 0, "exampl": 1, "fiber_view": [2, 3, 4, 7], "packag": [2, 3], "submodul": [2, 3], "annot": [], "modul": [2, 3], "cli": [], "plot": 2, "tool": [2, 3], "util": 2, "content": [2, 3], "fiber": 5, "view": 5, "document": 5, "instal": [5, 6], "usag": [5, 8], "test": 8, "subpackag": 2, "depr": 3}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"API": [[0, "api"]], "Examples": [[1, "examples"]], "fiber_views": [[4, "fiber-views"], [7, "fiber-views"]], "fiber-views documentation": [[5, "fiber-views-documentation"]], "Install:": [[5, null]], "Usage": [[5, null]], "Install": [[6, "install"]], "testing usage": [[8, "testing-usage"]], "fiber_views package": [[2, "fiber-views-package"]], "Subpackages": [[2, "subpackages"]], "Submodules": [[2, "submodules"], [3, "submodules"]], "fiber_views.fiber_views module": [[2, "fiber-views-fiber-views-module"]], "fiber_views.plot module": [[2, "fiber-views-plot-module"]], "fiber_views.tools module": [[2, "fiber-views-tools-module"]], "fiber_views.utils module": [[2, "fiber-views-utils-module"]], "Module contents": [[2, "module-contents"], [3, "module-contents"]], "fiber_views.depr package": [[3, "fiber-views-depr-package"]], "fiber_views.depr.fiber_views module": [[3, "fiber-views-depr-fiber-views-module"]], "fiber_views.depr.tools module": [[3, "fiber-views-depr-tools-module"]]}, "indexentries": {"readlist (class in fiber_views.utils)": [[2, "fiber_views.utils.ReadList"]], "agg_by_obs_and_bin() (in module fiber_views.tools)": [[2, "fiber_views.tools.agg_by_obs_and_bin"]], "annotate_boundaries() (in module fiber_views.plot)": [[2, "fiber_views.plot.annotate_boundaries"]], "bed_to_anno_df() (in module fiber_views.utils)": [[2, "fiber_views.utils.bed_to_anno_df"]], "bin_sparse_regions() (in module fiber_views.tools)": [[2, "fiber_views.tools.bin_sparse_regions"]], "build_anno_df() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.build_anno_df"]], "build_mod_array() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.build_mod_array"]], "build_mod_array_from_def() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.build_mod_array_from_def"]], "build_multi_fview() (in module fiber_views.fiber_views)": [[2, "fiber_views.fiber_views.build_multi_fview"]], "build_seq_array() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.build_seq_array"]], "build_single_fview() (in module fiber_views.fiber_views)": [[2, "fiber_views.fiber_views.build_single_fview"]], "build_sparse_region_array() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.build_sparse_region_array"]], "calc_kmer_dist() (in module fiber_views.tools)": [[2, "fiber_views.tools.calc_kmer_dist"]], "count_kmers() (in module fiber_views.tools)": [[2, "fiber_views.tools.count_kmers"]], "draw_fiber_bars() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_fiber_bars"]], "draw_fiber_lines() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_fiber_lines"]], "draw_mods() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_mods"]], "draw_mods_offset() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_mods_offset"]], "draw_regions() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_regions"]], "draw_split_lines() (in module fiber_views.plot)": [[2, "fiber_views.plot.draw_split_lines"]], "fiber_views": [[2, "module-fiber_views"]], "fiber_views.fiber_views": [[2, "module-fiber_views.fiber_views"]], "fiber_views.plot": [[2, "module-fiber_views.plot"]], "fiber_views.tools": [[2, "module-fiber_views.tools"]], "fiber_views.utils": [[2, "module-fiber_views.utils"]], "filter_by_end_meth() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.filter_by_end_meth"]], "filter_by_window() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.filter_by_window"]], "filter_regions() (in module fiber_views.tools)": [[2, "fiber_views.tools.filter_regions"]], "get_mod_pos_from_rec() (in module fiber_views.utils)": [[2, "fiber_views.utils.get_mod_pos_from_rec"]], "get_reads() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.get_reads"]], "get_seq_records() (in module fiber_views.tools)": [[2, "fiber_views.tools.get_seq_records"]], "get_sequences() (in module fiber_views.tools)": [[2, "fiber_views.tools.get_sequences"]], "get_strand_correct_mods() (in module fiber_views.utils)": [[2, "fiber_views.utils.get_strand_correct_mods"]], "get_strand_correct_mods_from_def() (in module fiber_views.utils)": [[2, "fiber_views.utils.get_strand_correct_mods_from_def"]], "get_strand_correct_regions() (in module fiber_views.utils)": [[2, "fiber_views.utils.get_strand_correct_regions"]], "make_dense_regions() (in module fiber_views.tools)": [[2, "fiber_views.tools.make_dense_regions"]], "make_plot_ax() (in module fiber_views.plot)": [[2, "fiber_views.plot.make_plot_ax"]], "make_region_df() (in module fiber_views.tools)": [[2, "fiber_views.tools.make_region_df"]], "make_sparse_regions() (in module fiber_views.utils)": [[2, "fiber_views.utils.make_sparse_regions"]], "mark_cpg_sites() (in module fiber_views.tools)": [[2, "fiber_views.tools.mark_cpg_sites"]], "module": [[2, "module-fiber_views"], [2, "module-fiber_views.fiber_views"], [2, "module-fiber_views.plot"], [2, "module-fiber_views.tools"], [2, "module-fiber_views.utils"], [3, "module-fiber_views.depr"], [3, "module-fiber_views.depr.fiber_views"], [3, "module-fiber_views.depr.tools"]], "print_aligned_centers() (fiber_views.utils.readlist method)": [[2, "fiber_views.utils.ReadList.print_aligned_centers"]], "print_mod_contexts() (in module fiber_views.utils)": [[2, "fiber_views.utils.print_mod_contexts"]], "read_bed() (in module fiber_views.utils)": [[2, "fiber_views.utils.read_bed"]], "split_fire() (in module fiber_views.tools)": [[2, "fiber_views.tools.split_fire"]], "strand (fiber_views.utils.readlist attribute)": [[2, "fiber_views.utils.ReadList.strand"]], "fiberview (class in fiber_views.depr.fiber_views)": [[3, "fiber_views.depr.fiber_views.FiberView"]], "build_fview() (in module fiber_views.depr.fiber_views)": [[3, "fiber_views.depr.fiber_views.build_fview"]], "fiber_views.depr": [[3, "module-fiber_views.depr"]], "fiber_views.depr.fiber_views": [[3, "module-fiber_views.depr.fiber_views"]], "fiber_views.depr.tools": [[3, "module-fiber_views.depr.tools"]], "get_seq_records() (fiber_views.depr.fiber_views.fiberview method)": [[3, "fiber_views.depr.fiber_views.FiberView.get_seq_records"]], "mark_cpg_sites() (fiber_views.depr.fiber_views.fiberview method)": [[3, "fiber_views.depr.fiber_views.FiberView.mark_cpg_sites"]], "plot_methylation() (in module fiber_views.depr.tools)": [[3, "fiber_views.depr.tools.plot_methylation"]], "plot_summary() (in module fiber_views.depr.tools)": [[3, "fiber_views.depr.tools.plot_summary"]], "simple_region_plot() (in module fiber_views.depr.tools)": [[3, "fiber_views.depr.tools.simple_region_plot"]]}})